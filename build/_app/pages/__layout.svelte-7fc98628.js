import{F as q,G as d,S as G,i as I,s as N,l as v,g as b,o as u,p as S,q as _,d as p,H as w,n as E,e as j,c as A,a as B,b as D,w as $,x as h,y as k,I as M,B as y,J as F,k as H,m as J,K,L,M as O}from"../chunks/vendor-4a9258b4.js";import{c as m}from"../chunks/category-store-9f0f87f3.js";import T from"../chunks/StartModal-56703465.js";import V from"../chunks/Navbar-bc0c341c.js";import z from"../chunks/AuthModal-d8058b78.js";import"../chunks/navigation-0e6511d1.js";import"../chunks/singletons-d1fb5791.js";const P=()=>{const n=q("__svelte__");return{page:{subscribe:n.page.subscribe},navigating:{subscribe:n.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:n.navigating.subscribe}},session:n.session,updated:n.updated}},C=n=>{throw new Error(`Cannot ${n} session store before subscribing`)},g={subscribe(n){const t=P().session;return g.set=t.set,g.update=t.update,t.subscribe(n)},set:()=>C("set"),update:()=>C("update")};function Q(n){let t,r,e,a;const i=[W,U],s=[];function l(o,c){return o[1].collection?1:0}return r=l(n),e=s[r]=i[r](n),{c(){t=j("div"),e.c(),this.h()},l(o){t=A(o,"DIV",{class:!0});var c=B(t);e.l(c),c.forEach(p),this.h()},h(){D(t,"class","wrapper svelte-hkifws")},m(o,c){b(o,t,c),s[r].m(t,null),a=!0},p(o,c){let f=r;r=l(o),r===f?s[r].p(o,c):(E(),u(s[f],1,1,()=>{s[f]=null}),S(),e=s[r],e?e.p(o,c):(e=s[r]=i[r](o),e.c()),_(e,1),e.m(t,null))},i(o){a||(_(e),a=!0)},o(o){u(e),a=!1},d(o){o&&p(t),s[r].d()}}}function R(n){let t,r;return t=new z({}),{c(){$(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,a){k(t,e,a),r=!0},p:M,i(e){r||(_(t.$$.fragment,e),r=!0)},o(e){u(t.$$.fragment,e),r=!1},d(e){y(t,e)}}}function U(n){let t,r,e;t=new V({});const a=n[3].default,i=F(a,n,n[2],null);return{c(){$(t.$$.fragment),r=H(),i&&i.c()},l(s){h(t.$$.fragment,s),r=J(s),i&&i.l(s)},m(s,l){k(t,s,l),b(s,r,l),i&&i.m(s,l),e=!0},p(s,l){i&&i.p&&(!e||l&4)&&K(i,a,s,s[2],e?O(a,s[2],l,null):L(s[2]),null)},i(s){e||(_(t.$$.fragment,s),_(i,s),e=!0)},o(s){u(t.$$.fragment,s),u(i,s),e=!1},d(s){y(t,s),s&&p(r),i&&i.d(s)}}}function W(n){let t,r;return t=new T({}),{c(){$(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,a){k(t,e,a),r=!0},p:M,i(e){r||(_(t.$$.fragment,e),r=!0)},o(e){u(t.$$.fragment,e),r=!1},d(e){y(t,e)}}}function X(n){let t,r,e,a;const i=[R,Q],s=[];function l(o,c){return o[0].user.status!=="logged_in"?0:1}return t=l(n),r=s[t]=i[t](n),{c(){r.c(),e=v()},l(o){r.l(o),e=v()},m(o,c){s[t].m(o,c),b(o,e,c),a=!0},p(o,[c]){let f=t;t=l(o),t===f?s[t].p(o,c):(E(),u(s[f],1,1,()=>{s[f]=null}),S(),r=s[t],r?r.p(o,c):(r=s[t]=i[t](o),r.c()),_(r,1),r.m(e.parentNode,e))},i(o){a||(_(r),a=!0)},o(o){u(r),a=!1},d(o){s[t].d(o),o&&p(e)}}}async function ne({fetch:n,stuff:t,session:r}){try{(await d("/api2/api/logged-in",{withCredentials:!0,method:"GET"})).status===200&&(r.user={status:"logged_in"})}catch{r.user={status:"logged_out"}}if(r.user.status==="logged_in")try{const e=await d("/api2/api/collection",{withCredentials:!0});try{const s=(await d("/api2/api/categories",{withCredentials:!0})).data.reduce((l,o)=>(l[o._id]=o,l),{});return m.update(l=>(l.collection=e.data,l.categories=s,l)),{}}catch(a){if(a.response&&a.response.status===403)return{props:{collection:null}}}}catch(e){return e.response.status===403&&m.update(a=>(a.collection=null,a)),e}return{}}function Y(n,t,r){let e,a;w(n,g,l=>r(0,e=l)),w(n,m,l=>r(1,a=l));let{$$slots:i={},$$scope:s}=t;return n.$$set=l=>{"$$scope"in l&&r(2,s=l.$$scope)},[e,a,s,i]}class ae extends G{constructor(t){super();I(this,t,Y,X,N,{})}}export{ae as default,ne as load};
